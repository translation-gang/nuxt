---
title: 'Автоимпорты'
description: 'Nuxt автоматически импортирует компоненты, композаблы, хелперы и API Vue.'
---

Nuxt автоматически импортирует компоненты, композаблы и [API Vue.js](https://vuejs.org/api/) по всему приложению — импортировать их вручную не нужно.

```vue twoslash [app/app.vue]
<script setup lang="ts">
const count = ref(1) // ref импортируется автоматически
</script>
```

Благодаря заданной структуре директорий Nuxt может автоимпортировать содержимое [`app/components/`](/docs/4.x/directory-structure/app/components), [`app/composables/`](/docs/4.x/directory-structure/app/composables) и [`app/utils/`](/docs/4.x/directory-structure/app/utils).

В отличие от глобального объявления, Nuxt сохраняет типы, подсказки и автодополнение в IDE и **включает в продакшен-код только то, что реально используется**.

::note
В документации каждая функция, которая не импортируется явно, автоимпортируется Nuxt и может использоваться как есть. Справка по автоимпортируемым компонентам, композаблам и утилитам — в [разделе API](/docs/4.x/api).
::

::note
В директории [`server`](/docs/4.x/directory-structure/server) Nuxt автоимпортирует экспортируемые функции и переменные из `server/utils/`.
::

::note
Автоимпорт из своих папок или сторонних пакетов можно настроить в секции [`imports`](/docs/4.x/api/nuxt-config#imports) файла `nuxt.config`.
::

## Встроенные автоимпорты

Nuxt автоимпортирует функции и композаблы для [получения данных](/docs/4.x/getting-started/data-fetching), доступа к [контексту приложения](/docs/4.x/api/composables/use-nuxt-app) и [runtime-конфигу](/docs/4.x/guide/going-further/runtime-config), [управления состоянием](/docs/4.x/getting-started/state-management), объявления компонентов и плагинов.

```vue twoslash
<script setup lang="ts">
/* useFetch() автоимпортируется */
const { data, refresh, status } = await useFetch('/api/hello')
</script>
```

Vue предоставляет API реактивности (`ref`, `computed`), хуки жизненного цикла и хелперы — они тоже автоимпортируются Nuxt.

```vue twoslash
<script setup lang="ts">
/* ref() и computed() автоимпортируются */
const count = ref(1)
const double = computed(() => count.value * 2)
</script>
```

### Композаблы Vue и Nuxt

<!-- TODO: move to separate page with https://github.com/nuxt/nuxt/issues/14723 and add more information -->

При использовании встроенных композаблов Vue и Nuxt важно вызывать их в правильном **контексте**.

В жизненном цикле компонента Vue отслеживает текущий экземпляр через глобальную переменную и сбрасывает её в том же тике. Аналогично Nuxt отслеживает временный экземпляр `nuxtApp`. Это нужно для SSR: чтобы не «протекало» состояние между запросами разных пользователей и между разными компонентами.

Поэтому (за редкими исключениями) композаблы нельзя вызывать вне Nuxt-плагина, Nuxt route middleware или функции setup компонента Vue. Кроме того, вызывать их нужно **синхронно** — нельзя использовать `await` перед вызовом композабла, кроме блоков `<script setup>`, функции setup компонента с `defineNuxtComponent`, `defineNuxtPlugin` и `defineNuxtRouteMiddleware`, где контекст сохраняется после `await`.

Если появляется ошибка вроде `Nuxt instance is unavailable`, скорее всего композабл Nuxt вызывается не в том месте жизненного цикла.

:video-accordion{title="Видео от Alexander Lichter: как избежать ошибки 'Nuxt instance is unavailable'" videoId="ofuKRZLtOdY"}

::tip
Если композабл требует контекст Nuxt внутри компонента не-SFC, оберните компонент в `defineNuxtComponent` вместо `defineComponent`.
::

::read-more{to="/docs/4.x/guide/going-further/experimental-features#asynccontext" icon="i-lucide-star"}
Экспериментальная возможность `asyncContext` позволяет использовать композаблы Nuxt в асинхронных функциях.
::

::read-more{to="https://github.com/nuxt/nuxt/issues/14269#issuecomment-1397352832" target="_blank"}
Подробное объяснение в комментарии на GitHub.
::

**Пример некорректного кода:**

```ts twoslash [composables/example.ts]
// попытка доступа к runtime config вне композабла
const config = useRuntimeConfig()

export const useMyComposable = () => {
  // использование config здесь
}
```

**Пример корректного кода:**

```ts twoslash [composables/example.ts]
export const useMyComposable = () => {
  // композабл вызывается в нужном месте жизненного цикла,
  // useRuntimeConfig здесь работает
  const config = useRuntimeConfig()

  // ...
}
```

## Автоимпорты по директориям

Nuxt автоимпортирует файлы из заданных директорий:

- `app/components/` — [компоненты Vue](/docs/4.x/directory-structure/app/components);
- `app/composables/` — [композаблы Vue](/docs/4.x/directory-structure/app/composables);
- `app/utils/` — хелперы и утилиты.

:link-example{to="/docs/4.x/examples/features/auto-imports"}

::warning
**Автоимпортированные `ref` и `computed` не разворачиваются в `<template>` компонента.** :br
Это связано с тем, как Vue обрабатывает ref'ы не верхнего уровня в шаблоне. Подробнее — в [документации Vue](https://vuejs.org/guide/essentials/reactivity-fundamentals#caveat-when-unwrapping-in-templates).
::

### Явный импорт

Nuxt предоставляет алиас `#imports` для всех автоимпортов — при необходимости импорт можно сделать явным:

<!-- TODO:twoslash: Twoslash does not support tsconfig paths yet -->

```vue
<script setup lang="ts">
import { computed, ref } from '#imports'

const count = ref(1)
const double = computed(() => count.value * 2)
</script>
```

### Отключение автоимпортов

Чтобы отключить автоимпорт композаблов и утилит, в `nuxt.config` задайте `imports.autoImport: false`:

```ts twoslash [nuxt.config.ts]
export default defineNuxtConfig({
  imports: {
    autoImport: false,
  },
})
```

Автоимпорты отключатся полностью, но по-прежнему можно использовать [явный импорт](/docs/4.x/guide/concepts/auto-imports#explicit-imports) из `#imports`.

### Частичное отключение автоимпортов

Если нужно оставить автоимпорт функций фреймворка (например `ref`), но отключить автоимпорт своего кода (композаблы и т.д.), в `nuxt.config.ts` задайте `imports.scan: false`:

```ts
export default defineNuxtConfig({
  imports: {
    scan: false,
  },
})
```

При такой настройке:
- функции вроде `ref`, `computed`, `watch` по-прежнему доступны без импорта;
- свой код (композаблы и др.) нужно импортировать вручную.

::warning
**Внимание:** у такой настройки есть ограничения:
- при использовании слоёв композаблы из каждого слоя нужно импортировать явно;
- переопределение из слоёв перестаёт работать. При `imports.scan: false` учитывайте это при проектировании.
::

## Автоимпорт компонентов

Nuxt также автоматически импортирует компоненты из `~/components`, хотя эта настройка отдельна от автоимпорта композаблов и утилит.

:read-more{to="/docs/4.x/directory-structure/app/components"}

Чтобы отключить автоимпорт компонентов из своей `~/components`, задайте `components.dirs` пустым массивом (это не затронет компоненты, добавленные модулями):

```ts twoslash [nuxt.config.ts]
export default defineNuxtConfig({
  components: {
    dirs: [],
  },
})
```

## Автоимпорт из сторонних пакетов

Nuxt позволяет автоимпортировать из сторонних пакетов.

::tip
Если у пакета есть Nuxt-модуль, скорее всего он уже настроил автоимпорты для этого пакета.
::

Например, автоимпорт композабла `useI18n` из `vue-i18n` можно включить так:

```ts twoslash [nuxt.config.ts]
export default defineNuxtConfig({
  imports: {
    presets: [
      {
        from: 'vue-i18n',
        imports: ['useI18n'],
      },
    ],
  },
})
```

:video-accordion{title="Видео от Alexander Lichter: настройка своих автоимпортов" videoId="FT2LQJ2NvVI"}
